# =============================================================================
# BSLT — .env.production
# =============================================================================

# =============================================================================
# 1. Core Application
# =============================================================================
NODE_ENV=production  # options: development | production | test
HOST=0.0.0.0
PORT=8080
API_PORT=8080
APP_PORT=5173
APP_BASE_URL=  # REQUIRED: Set in deployment (e.g., https://your-app.com)
API_BASE_URL=  # REQUIRED: Set in deployment (e.g., https://api.your-app.com)
APP_URL=  # REQUIRED: Set in deployment (e.g., https://your-app.com)
# PUBLIC_APP_URL=              # Override for public-facing app URL (priority over APP_URL)
# PUBLIC_API_URL=              # Override for public-facing API URL (priority over VITE_API_URL)
LOG_LEVEL=info  # options: trace | debug | info | warn | error | fatal
LOG_CLIENT_ERROR_LEVEL=warn  # options: trace | debug | info | warn | error | fatal
LOG_REQUEST_CONTEXT=true  # options: true | false
LOG_PRETTY_JSON=false  # options: true | false
MAINTENANCE_MODE=false
AUDIT_RETENTION_DAYS=90  # 0 = unlimited

# =============================================================================
# 2. Frontend (Vite)
# =============================================================================
VITE_API_URL=  # REQUIRED: Set in deployment (e.g., https://api.your-app.com)
VITE_APP_NAME=bslt-web

# =============================================================================
# 3. Provider Switches
# =============================================================================
DATABASE_PROVIDER=postgresql  # options: postgresql | sqlite | mongodb | json
STORAGE_PROVIDER=s3  # options: local | s3
QUEUE_PROVIDER=local  # options: local | redis
CACHE_PROVIDER=local  # options: local | redis
SEARCH_PROVIDER=sql  # options: sql | elasticsearch
EMAIL_PROVIDER=smtp  # options: console | smtp | api
BILLING_PROVIDER=stripe  # options: stripe | paypal
NOTIFICATIONS_PROVIDER=onesignal  # options: onesignal | fcm | courier | knock | sns | braze | generic
AUTH_STRATEGIES=local  # comma-separated: local, magic, webauthn, google, github, kakao, facebook, microsoft, apple

# =============================================================================
# 4. Auth — Secrets & Tokens
# =============================================================================
JWT_SECRET=  # REQUIRED: Generate with `openssl rand -base64 48`
JWT_SECRET_PREVIOUS=
JWT_ISSUER=bslt
JWT_AUDIENCE=bslt-api
ACCESS_TOKEN_EXPIRY=15m
REFRESH_TOKEN_EXPIRY_DAYS=7
REFRESH_TOKEN_GRACE_PERIOD=30
COOKIE_SECRET=  # REQUIRED: Generate with `openssl rand -base64 48`

# =============================================================================
# 5. Auth — Password & Lockout
# =============================================================================
PASSWORD_MIN_LENGTH=8
PASSWORD_MAX_LENGTH=24
PASSWORD_MIN_SCORE=3
LOCKOUT_MAX_ATTEMPTS=10
LOCKOUT_DURATION_MS=1800000
MAGIC_LINK_EXPIRY_MINUTES=15
MAGIC_LINK_MAX_ATTEMPTS=3
TOTP_ISSUER=BSLT
TOTP_WINDOW=1
CAPTCHA_ENABLED=false  # options: true | false
# CAPTCHA_PROVIDER=turnstile  # options: turnstile
# CAPTCHA_SITE_KEY=
# CAPTCHA_SECRET_KEY=

# =============================================================================
# 6. Auth — OAuth Providers
# =============================================================================
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=
GOOGLE_CALLBACK_URL=
GITHUB_CLIENT_ID=
GITHUB_CLIENT_SECRET=
GITHUB_CALLBACK_URL=
KAKAO_CLIENT_ID=
KAKAO_CLIENT_SECRET=
KAKAO_CALLBACK_URL=
FACEBOOK_CLIENT_ID=
FACEBOOK_CLIENT_SECRET=
FACEBOOK_CALLBACK_URL=
MICROSOFT_CLIENT_ID=
MICROSOFT_CLIENT_SECRET=
MICROSOFT_CALLBACK_URL=
MICROSOFT_TENANT_ID=common
APPLE_CLIENT_ID=
APPLE_TEAM_ID=
APPLE_KEY_ID=
APPLE_PRIVATE_KEY=
APPLE_PRIVATE_KEY_BASE64=
APPLE_CALLBACK_URL=

# =============================================================================
# 7. CORS / Proxy
# =============================================================================
CORS_ORIGIN=  # REQUIRED: Set in deployment (e.g., https://your-app.com)
# CORS_ORIGINS=                # Comma-separated list (takes priority over CORS_ORIGIN)
TRUST_PROXY=true  # options: true | false
TRUSTED_PROXIES=172.16.0.0/12,10.0.0.0/8
MAX_PROXY_DEPTH=1

# =============================================================================
# 8. Rate Limiting
# =============================================================================
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX=100
# RATE_LIMIT_LOGIN_MAX=5             # Default: 5 (prod) / 100 (dev)
# RATE_LIMIT_REGISTER_MAX=3          # Default: 3 (prod) / 100 (dev)
# RATE_LIMIT_FORGOT_PASSWORD_MAX=3   # Default: 3 (prod) / 100 (dev)
# RATE_LIMIT_VERIFY_EMAIL_MAX=10     # Default: 10 (prod) / 100 (dev)

# =============================================================================
# 9. Database
# =============================================================================
DATABASE_URL=  # REQUIRED: e.g., postgresql://user:pass@host:5432/dbname
POSTGRES_CONNECTION_STRING=
POSTGRES_HOST=
POSTGRES_PORT=5432
POSTGRES_DB=
POSTGRES_USER=
POSTGRES_PASSWORD=
DB_MAX_CONNECTIONS=20
DB_SSL=true  # options: true | false
# DATABASE_READ_REPLICA_URL=  # Read replica connection string
JSON_DB_PATH=.data/db.json
JSON_DB_PERSIST_ON_WRITE=true
# SQLITE_FILE_PATH=.data/sqlite.db
# SQLITE_WAL_MODE=true              # options: true | false
# SQLITE_FOREIGN_KEYS=true          # options: true | false
# SQLITE_TIMEOUT_MS=5000
# MONGODB_CONNECTION_STRING=
# MONGODB_DATABASE=
# MONGODB_DB=bslt_dev
# MONGODB_SSL=true                   # options: true | false
# MONGODB_CONNECT_TIMEOUT_MS=30000
# MONGODB_SOCKET_TIMEOUT_MS=30000
# MONGODB_USE_UNIFIED_TOPOLOGY=true  # options: true | false

# =============================================================================
# 10. Cache / Redis
# =============================================================================
CACHE_USE_REDIS=false  # options: true | false
CACHE_TTL_MS=300000
CACHE_MAX_SIZE=1000
REDIS_HOST=
REDIS_PORT=6379
# REDIS_PASSWORD=
# REDIS_DB=0

# =============================================================================
# 11. Queue
# =============================================================================
QUEUE_POLL_INTERVAL_MS=1000
QUEUE_CONCURRENCY=5
QUEUE_MAX_ATTEMPTS=3
QUEUE_BACKOFF_BASE_MS=1000
QUEUE_MAX_BACKOFF_MS=300000

# =============================================================================
# 12. Storage
# =============================================================================
STORAGE_ROOT_PATH=main/apps/server/uploads
STORAGE_PUBLIC_BASE_URL=
S3_BUCKET=  # REQUIRED if STORAGE_PROVIDER=s3
S3_REGION=  # REQUIRED if STORAGE_PROVIDER=s3
S3_ACCESS_KEY_ID=  # REQUIRED in production if STORAGE_PROVIDER=s3
S3_SECRET_ACCESS_KEY=  # REQUIRED in production if STORAGE_PROVIDER=s3
S3_ENDPOINT=
S3_FORCE_PATH_STYLE=false  # options: true | false
S3_PRESIGN_EXPIRES_IN_SECONDS=3600

# =============================================================================
# 13. Email
# =============================================================================
EMAIL_API_KEY=
EMAIL_FROM_NAME=BSLT
EMAIL_FROM_ADDRESS=  # REQUIRED: Set your production from address
EMAIL_REPLY_TO=
SMTP_HOST=  # REQUIRED if EMAIL_PROVIDER=smtp
SMTP_PORT=587
SMTP_SECURE=true  # options: true | false
SMTP_USER=
SMTP_PASS=
SMTP_CONNECTION_TIMEOUT=5000
SMTP_SOCKET_TIMEOUT=30000

# =============================================================================
# 14. Search
# =============================================================================
SQL_SEARCH_DEFAULT_PAGE_SIZE=50
SQL_SEARCH_MAX_PAGE_SIZE=1000
SQL_SEARCH_MAX_QUERY_DEPTH=5
SQL_SEARCH_MAX_CONDITIONS=20
SQL_SEARCH_LOGGING=false  # options: true | false
SQL_SEARCH_TIMEOUT_MS=5000
# ELASTICSEARCH_NODE=http://localhost:9200
# ELASTICSEARCH_INDEX=default
# ELASTICSEARCH_USERNAME=
# ELASTICSEARCH_PASSWORD=
# ELASTICSEARCH_API_KEY=
# ELASTICSEARCH_TLS=true             # options: true | false
# ELASTICSEARCH_REQUEST_TIMEOUT_MS=

# =============================================================================
# 15. Billing
# =============================================================================
BILLING_CURRENCY=usd
BILLING_PORTAL_RETURN_URL=
BILLING_CHECKOUT_SUCCESS_URL=
BILLING_CHECKOUT_CANCEL_URL=
STRIPE_SECRET_KEY=
STRIPE_PUBLISHABLE_KEY=
STRIPE_WEBHOOK_SECRET=
PAYPAL_CLIENT_ID=
PAYPAL_CLIENT_SECRET=
PAYPAL_MODE=production  # options: sandbox | production
PAYPAL_WEBHOOK_ID=
PLAN_FREE_ID=plan_free
PLAN_PRO_ID=plan_pro
PLAN_ENTERPRISE_ID=plan_enterprise

# =============================================================================
# 16. Notifications
# =============================================================================
ONESIGNAL_APP_ID=
ONESIGNAL_REST_API_KEY=
ONESIGNAL_USER_AUTH_KEY=
ONESIGNAL_ENABLE_LOGGING=false  # options: true | false
# FCM_PROJECT_ID=
# FCM_CREDENTIALS=
# COURIER_API_KEY=
# COURIER_API_URL=https://api.courier.com
# COURIER_ENABLE_LOGGING=false       # options: true | false

# =============================================================================
# 17. Package Manager
# =============================================================================
PACKAGE_MANAGER_PROVIDER=pnpm  # options: pnpm | npm | yarn
NPM_AUDIT=true
NPM_LEGACY_PEER_DEPS=false
NPM_REGISTRY=https://registry.npmjs.org/
PNPM_STRICT_PEER_DEPS=true
PNPM_FROZEN_LOCKFILE=true
PNPM_REGISTRY=https://registry.npmjs.org/
YARN_AUDIT=true
YARN_FROZEN_LOCKFILE=true
YARN_REGISTRY=https://registry.npmjs.org/

APPLE_CLIENT_SECRET=

AWS_SNS_ACCESS_KEY_ID=

AWS_SNS_REGION=

AWS_SNS_SECRET_ACCESS_KEY=

AWS_SNS_TOPIC_ARN=

BRAZE_API_KEY=

BRAZE_API_URL=

BRAZE_ENABLE_LOGGING=

CAPTCHA_PROVIDER=

CAPTCHA_SECRET_KEY=

CAPTCHA_SITE_KEY=

CORS_ORIGINS=

COURIER_API_KEY=

COURIER_API_URL=

COURIER_ENABLE_LOGGING=

DATABASE_READ_REPLICA_URL=

ELASTICSEARCH_API_KEY=

ELASTICSEARCH_INDEX=

ELASTICSEARCH_NODE=

ELASTICSEARCH_PASSWORD=

ELASTICSEARCH_REQUEST_TIMEOUT_MS=

ELASTICSEARCH_TLS=

ELASTICSEARCH_USERNAME=

FCM_CREDENTIALS=

FCM_PROJECT_ID=

HEALTH_PORT=

KNOCK_API_URL=

KNOCK_ENABLE_LOGGING=

KNOCK_SECRET_KEY=

MONGODB_CONNECTION_STRING=

MONGODB_CONNECT_TIMEOUT_MS=

MONGODB_DATABASE=

MONGODB_DB=

MONGODB_SOCKET_TIMEOUT_MS=

MONGODB_SSL=

MONGODB_USE_UNIFIED_TOPOLOGY=

NEXT_PUBLIC_APP_URL=

OAUTH_TOKEN_ENCRYPTION_KEY=

PUBLIC_API_URL=

PUBLIC_APP_URL=

RATE_LIMIT_FORGOT_PASSWORD_MAX=

RATE_LIMIT_LOGIN_MAX=

RATE_LIMIT_REGISTER_MAX=

RATE_LIMIT_VERIFY_EMAIL_MAX=

REDIS_DB=

REDIS_PASSWORD=

REQUIRED_VAR=

SQLITE_FILE_PATH=

SQLITE_FOREIGN_KEYS=

SQLITE_TIMEOUT_MS=

SQLITE_WAL_MODE=

VAPID_PRIVATE_KEY=

VAPID_PUBLIC_KEY=
