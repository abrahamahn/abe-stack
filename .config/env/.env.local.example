# =============================================================================
# ABE STACK - .env.local (Optimized for Local Development)
# =============================================================================

# =============================================================================
# Package Manager
# =============================================================================
PACKAGE_MANAGER_PROVIDER=pnpm
NPM_AUDIT=true
NPM_LEGACY_PEER_DEPS=false
NPM_REGISTRY=https://registry.npmjs.org/
PNPM_STRICT_PEER_DEPS=true
PNPM_FROZEN_LOCKFILE=true
PNPM_REGISTRY=https://registry.npmjs.org/
YARN_AUDIT=true
YARN_FROZEN_LOCKFILE=true
YARN_REGISTRY=https://registry.npmjs.org/

# =============================================================================
# Application
# =============================================================================
NODE_ENV=development
APP_PORT=5173
API_PORT=8080
APP_BASE_URL=http://localhost:5173
API_BASE_URL=http://localhost:8080
APP_URL=http://localhost:5173
HOST=0.0.0.0
PORT=8080
LOG_LEVEL=debug  # Optimized for local visibility
MAINTENANCE_MODE=false

# =============================================================================
# Frontend (Vite)
# =============================================================================
VITE_API_URL=http://localhost:8080
VITE_APP_NAME=abe-stack-web

# =============================================================================
# CORS / Proxy
# =============================================================================
CORS_ORIGIN=http://localhost:5173
TRUST_PROXY=false
TRUSTED_PROXIES=127.0.0.1
MAX_PROXY_DEPTH=1

# =============================================================================
# Auth / Security
# =============================================================================
JWT_SECRET=this_is_a_development_secret_that_is_long_enough_for_development_purposes
JWT_SECRET_PREVIOUS=
JWT_ISSUER=abe-stack
JWT_AUDIENCE=abe-stack-api
ACCESS_TOKEN_EXPIRY=15m
REFRESH_TOKEN_EXPIRY_DAYS=7
REFRESH_TOKEN_GRACE_PERIOD=30
COOKIE_SECRET=2jPf_x42yWXT1CWqvy-GApfhIiQy8dOVeH6IvQFIgWuf-2cwN65ktbFm5-_c6PgO
SESSION_SECRET=jkoCEnsDlxwFbmj_hfCpkp_S9_ikdAK9agRURfGvhJyD1Wg9MWT-Rwv4ALOcsncM
AUTH_BFF_MODE=false
PASSWORD_MIN_LENGTH=8
PASSWORD_MAX_LENGTH=24
PASSWORD_MIN_SCORE=3
LOCKOUT_MAX_ATTEMPTS=10
LOCKOUT_DURATION_MS=1800000
MAGIC_LINK_EXPIRY_MINUTES=15
MAGIC_LINK_MAX_ATTEMPTS=3
TOTP_ISSUER=ABE Stack
TOTP_WINDOW=1

# =============================================================================
# Rate Limiting
# =============================================================================
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX=1000
RATE_LIMIT_CLEANUP_INTERVAL_MS=60000
RATE_LIMIT_PROGRESSIVE_DELAY_ENABLED=false
RATE_LIMIT_BASE_DELAY_MS=1000
RATE_LIMIT_MAX_DELAY_MS=10000

# =============================================================================
# Provider Switches (Local Postgres)
# =============================================================================
DATABASE_PROVIDER=postgresql
STORAGE_PROVIDER=local
QUEUE_PROVIDER=local
SEARCH_PROVIDER=sql
EMAIL_PROVIDER=console
BILLING_PROVIDER=stripe
NOTIFICATIONS_PROVIDER=courier
CACHE_PROVIDER=local
AUTH_STRATEGIES=local,magic-link

# =============================================================================
# Database (Local Postgres)
# =============================================================================
DATABASE_URL=postgresql://postgres:postgres@localhost:5433/abe_stack_dev
POSTGRES_CONNECTION_STRING=
POSTGRES_HOST=localhost
POSTGRES_PORT=5433
POSTGRES_DB=abe_stack_dev
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
DB_MAX_CONNECTIONS=10
DB_SSL=false

# =============================================================================
# Cache / Redis
# =============================================================================
CACHE_USE_REDIS=false
CACHE_TTL_MS=300000
CACHE_MAX_SIZE=1000
REDIS_HOST=localhost
REDIS_PORT=6379

# =============================================================================
# Queue
# =============================================================================
QUEUE_POLL_INTERVAL_MS=1000
QUEUE_CONCURRENCY=5
QUEUE_MAX_ATTEMPTS=3
QUEUE_BACKOFF_BASE_MS=1000
QUEUE_MAX_BACKOFF_MS=300000

# =============================================================================
# Storage
# =============================================================================
STORAGE_ROOT_PATH=apps/server/uploads
STORAGE_PUBLIC_BASE_URL=http://localhost:8080/uploads

# =============================================================================
# Email
# =============================================================================
EMAIL_FROM_NAME=ABE Stack (Local)
EMAIL_FROM_ADDRESS=noreply@example.com
EMAIL_REPLY_TO=noreply@example.com

# =============================================================================
# Billing
# =============================================================================
BILLING_CURRENCY=usd
BILLING_PORTAL_RETURN_URL=http://localhost:5173/settings/billing
BILLING_CHECKOUT_SUCCESS_URL=http://localhost:5173/billing/success
BILLING_CHECKOUT_CANCEL_URL=http://localhost:5173/pricing
PLAN_FREE_ID=plan_free
PLAN_PRO_ID=plan_pro
PLAN_ENTERPRISE_ID=plan_enterprise

# =============================================================================
# Search
# =============================================================================
SQL_SEARCH_DEFAULT_PAGE_SIZE=50
SQL_SEARCH_MAX_PAGE_SIZE=1000
SQL_SEARCH_LOGGING=true  # Logging enabled for local search debugging
