// main/client/api/src/generated/client.ts
/* eslint-disable @typescript-eslint/no-misused-spread, @typescript-eslint/no-unsafe-assignment */
// main/client/api/src/generated/client.ts
/**
 * AUTO-GENERATED FILE. DO NOT EDIT.
 *
 * Generated by: main/tools/scripts/api/generate-client.ts
 * Source: route definitions registered via route-manifest.
 */

import { trimTrailingSlashes } from '../utils';

import type { BaseClientConfig } from '../utils';

export const generatedRouteDefinitions = [
  { method: 'GET', path: '/api/activities', module: 'activities', public: false },
  { method: 'GET', path: '/api/admin/audit-events', module: 'admin', public: false },
  { method: 'POST', path: '/api/admin/auth/unlock', module: 'admin', public: false },
  { method: 'GET', path: '/api/admin/billing/plans', module: 'admin', public: false },
  { method: 'GET', path: '/api/admin/billing/plans/:id', module: 'admin', public: false },
  {
    method: 'POST',
    path: '/api/admin/billing/plans/:id/deactivate',
    module: 'admin',
    public: false,
  },
  {
    method: 'POST',
    path: '/api/admin/billing/plans/:id/sync-stripe',
    module: 'admin',
    public: false,
  },
  { method: 'POST', path: '/api/admin/billing/plans/:id/update', module: 'admin', public: false },
  { method: 'POST', path: '/api/admin/billing/plans/create', module: 'admin', public: false },
  { method: 'GET', path: '/api/admin/feature-flags', module: 'feature-flags', public: false },
  {
    method: 'POST',
    path: '/api/admin/feature-flags/:key/delete',
    module: 'feature-flags',
    public: false,
  },
  {
    method: 'POST',
    path: '/api/admin/feature-flags/:key/update',
    module: 'feature-flags',
    public: false,
  },
  {
    method: 'POST',
    path: '/api/admin/feature-flags/create',
    module: 'feature-flags',
    public: false,
  },
  { method: 'GET', path: '/api/admin/health', module: 'admin', public: false },
  { method: 'POST', path: '/api/admin/impersonate/:userId', module: 'admin', public: false },
  { method: 'POST', path: '/api/admin/impersonate/end', module: 'admin', public: false },
  { method: 'GET', path: '/api/admin/jobs', module: 'admin', public: false },
  { method: 'GET', path: '/api/admin/jobs/:jobId', module: 'admin', public: false },
  { method: 'POST', path: '/api/admin/jobs/:jobId/cancel', module: 'admin', public: false },
  { method: 'POST', path: '/api/admin/jobs/:jobId/retry', module: 'admin', public: false },
  { method: 'GET', path: '/api/admin/jobs/stats', module: 'admin', public: false },
  { method: 'POST', path: '/api/admin/legal/publish', module: 'legal', public: false },
  { method: 'GET', path: '/api/admin/metrics', module: 'admin', public: false },
  { method: 'GET', path: '/api/admin/routes', module: 'admin', public: false },
  { method: 'POST', path: '/api/admin/security/events', module: 'admin', public: false },
  { method: 'GET', path: '/api/admin/security/events/:id', module: 'admin', public: false },
  { method: 'POST', path: '/api/admin/security/export', module: 'admin', public: false },
  { method: 'GET', path: '/api/admin/security/metrics', module: 'admin', public: false },
  { method: 'GET', path: '/api/admin/tenants', module: 'admin', public: false },
  { method: 'GET', path: '/api/admin/tenants/:id', module: 'admin', public: false },
  { method: 'POST', path: '/api/admin/tenants/:id/suspend', module: 'admin', public: false },
  { method: 'POST', path: '/api/admin/tenants/:id/unsuspend', module: 'admin', public: false },
  {
    method: 'GET',
    path: '/api/admin/tenants/:tenantId/feature-overrides',
    module: 'feature-flags',
    public: false,
  },
  {
    method: 'PUT',
    path: '/api/admin/tenants/:tenantId/feature-overrides/:key',
    module: 'feature-flags',
    public: false,
  },
  {
    method: 'POST',
    path: '/api/admin/tenants/:tenantId/feature-overrides/:key/delete',
    module: 'feature-flags',
    public: false,
  },
  { method: 'GET', path: '/api/admin/users', module: 'admin', public: false },
  { method: 'GET', path: '/api/admin/users/:id', module: 'admin', public: false },
  { method: 'POST', path: '/api/admin/users/:id/hard-ban', module: 'admin', public: false },
  { method: 'POST', path: '/api/admin/users/:id/lock', module: 'admin', public: false },
  { method: 'POST', path: '/api/admin/users/:id/unlock', module: 'admin', public: false },
  { method: 'POST', path: '/api/admin/users/:id/update', module: 'admin', public: false },
  { method: 'GET', path: '/api/admin/users/search', module: 'admin', public: false },
  { method: 'GET', path: '/api/admin/webhooks', module: 'admin', public: false },
  { method: 'GET', path: '/api/admin/webhooks/:id/deliveries', module: 'admin', public: false },
  {
    method: 'POST',
    path: '/api/admin/webhooks/:id/deliveries/:deliveryId/replay',
    module: 'admin',
    public: false,
  },
  { method: 'POST', path: '/api/auth/change-email', module: 'auth', public: false },
  { method: 'POST', path: '/api/auth/change-email/confirm', module: 'auth', public: true },
  { method: 'POST', path: '/api/auth/change-email/revert', module: 'auth', public: true },
  { method: 'POST', path: '/api/auth/forgot-password', module: 'auth', public: true },
  { method: 'POST', path: '/api/auth/invalidate-sessions', module: 'auth', public: false },
  { method: 'POST', path: '/api/auth/login', module: 'auth', public: true },
  { method: 'POST', path: '/api/auth/logout', module: 'auth', public: true },
  { method: 'POST', path: '/api/auth/logout-all', module: 'auth', public: false },
  { method: 'POST', path: '/api/auth/magic-link/request', module: 'auth', public: true },
  { method: 'POST', path: '/api/auth/magic-link/verify', module: 'auth', public: true },
  { method: 'GET', path: '/api/auth/oauth/apple', module: 'auth', public: true },
  { method: 'GET', path: '/api/auth/oauth/apple/callback', module: 'auth', public: true },
  { method: 'POST', path: '/api/auth/oauth/apple/link', module: 'auth', public: false },
  { method: 'DELETE', path: '/api/auth/oauth/apple/unlink', module: 'auth', public: false },
  { method: 'GET', path: '/api/auth/oauth/connections', module: 'auth', public: false },
  { method: 'GET', path: '/api/auth/oauth/github', module: 'auth', public: true },
  { method: 'GET', path: '/api/auth/oauth/github/callback', module: 'auth', public: true },
  { method: 'POST', path: '/api/auth/oauth/github/link', module: 'auth', public: false },
  { method: 'DELETE', path: '/api/auth/oauth/github/unlink', module: 'auth', public: false },
  { method: 'GET', path: '/api/auth/oauth/google', module: 'auth', public: true },
  { method: 'GET', path: '/api/auth/oauth/google/callback', module: 'auth', public: true },
  { method: 'POST', path: '/api/auth/oauth/google/link', module: 'auth', public: false },
  { method: 'DELETE', path: '/api/auth/oauth/google/unlink', module: 'auth', public: false },
  { method: 'GET', path: '/api/auth/oauth/providers', module: 'auth', public: true },
  { method: 'POST', path: '/api/auth/password/change', module: 'auth', public: false },
  { method: 'POST', path: '/api/auth/refresh', module: 'auth', public: true },
  { method: 'POST', path: '/api/auth/register', module: 'auth', public: true },
  { method: 'POST', path: '/api/auth/resend-verification', module: 'auth', public: true },
  { method: 'POST', path: '/api/auth/reset-password', module: 'auth', public: true },
  { method: 'POST', path: '/api/auth/set-password', module: 'auth', public: false },
  { method: 'POST', path: '/api/auth/sms/send', module: 'auth', public: true },
  { method: 'POST', path: '/api/auth/sms/verify', module: 'auth', public: true },
  { method: 'POST', path: '/api/auth/sudo', module: 'auth', public: false },
  { method: 'POST', path: '/api/auth/tos/accept', module: 'auth', public: false },
  { method: 'GET', path: '/api/auth/tos/status', module: 'auth', public: false },
  { method: 'POST', path: '/api/auth/totp/disable', module: 'auth', public: false },
  { method: 'POST', path: '/api/auth/totp/enable', module: 'auth', public: false },
  { method: 'POST', path: '/api/auth/totp/setup', module: 'auth', public: false },
  { method: 'GET', path: '/api/auth/totp/status', module: 'auth', public: false },
  { method: 'POST', path: '/api/auth/totp/verify-login', module: 'auth', public: true },
  { method: 'POST', path: '/api/auth/verify-email', module: 'auth', public: true },
  { method: 'POST', path: '/api/auth/webauthn/login/options', module: 'auth', public: true },
  { method: 'POST', path: '/api/auth/webauthn/login/verify', module: 'auth', public: true },
  { method: 'POST', path: '/api/auth/webauthn/register/options', module: 'auth', public: false },
  { method: 'POST', path: '/api/auth/webauthn/register/verify', module: 'auth', public: false },
  { method: 'POST', path: '/api/billing/checkout', module: 'billing', public: false },
  { method: 'GET', path: '/api/billing/invoices', module: 'billing', public: false },
  { method: 'GET', path: '/api/billing/invoices/:id', module: 'billing', public: false },
  { method: 'GET', path: '/api/billing/payment-methods', module: 'billing', public: false },
  { method: 'DELETE', path: '/api/billing/payment-methods/:id', module: 'billing', public: false },
  {
    method: 'POST',
    path: '/api/billing/payment-methods/:id/default',
    module: 'billing',
    public: false,
  },
  { method: 'POST', path: '/api/billing/payment-methods/add', module: 'billing', public: false },
  { method: 'GET', path: '/api/billing/plans', module: 'billing', public: true },
  { method: 'POST', path: '/api/billing/portal', module: 'billing', public: false },
  { method: 'POST', path: '/api/billing/setup-intent', module: 'billing', public: false },
  { method: 'GET', path: '/api/billing/subscription', module: 'billing', public: false },
  { method: 'POST', path: '/api/billing/subscription/cancel', module: 'billing', public: false },
  { method: 'POST', path: '/api/billing/subscription/resume', module: 'billing', public: false },
  { method: 'POST', path: '/api/billing/subscription/update', module: 'billing', public: false },
  { method: 'GET', path: '/api/billing/usage', module: 'billing', public: false },
  { method: 'GET', path: '/api/email/unsubscribe/:token', module: 'notifications', public: true },
  { method: 'GET', path: '/api/feature-flags/evaluate', module: 'feature-flags', public: false },
  { method: 'GET', path: '/api/files/:id', module: 'files', public: false },
  { method: 'POST', path: '/api/files/:id/delete', module: 'files', public: false },
  { method: 'GET', path: '/api/files/:id/download', module: 'files', public: false },
  { method: 'POST', path: '/api/files/upload', module: 'files', public: false },
  { method: 'POST', path: '/api/invitations/:id/accept', module: 'tenants', public: false },
  { method: 'GET', path: '/api/legal/current', module: 'legal', public: true },
  { method: 'POST', path: '/api/notifications/delete', module: 'notifications', public: false },
  { method: 'GET', path: '/api/notifications/list', module: 'notifications', public: false },
  {
    method: 'POST',
    path: '/api/notifications/mark-all-read',
    module: 'notifications',
    public: false,
  },
  { method: 'POST', path: '/api/notifications/mark-read', module: 'notifications', public: false },
  { method: 'GET', path: '/api/notifications/preferences', module: 'notifications', public: false },
  {
    method: 'PUT',
    path: '/api/notifications/preferences/update',
    module: 'notifications',
    public: false,
  },
  { method: 'POST', path: '/api/notifications/send', module: 'notifications', public: false },
  { method: 'POST', path: '/api/notifications/subscribe', module: 'notifications', public: false },
  { method: 'POST', path: '/api/notifications/test', module: 'notifications', public: false },
  {
    method: 'POST',
    path: '/api/notifications/unsubscribe',
    module: 'notifications',
    public: false,
  },
  { method: 'GET', path: '/api/notifications/vapid-key', module: 'notifications', public: true },
  { method: 'POST', path: '/api/tenants', module: 'tenants', public: false },
  { method: 'GET', path: '/api/tenants/:id', module: 'tenants', public: false },
  { method: 'GET', path: '/api/tenants/:id/audit-events', module: 'tenants', public: false },
  { method: 'POST', path: '/api/tenants/:id/delete', module: 'tenants', public: false },
  { method: 'POST', path: '/api/tenants/:id/invitations', module: 'tenants', public: false },
  {
    method: 'POST',
    path: '/api/tenants/:id/invitations/:invitationId/regenerate',
    module: 'tenants',
    public: false,
  },
  {
    method: 'POST',
    path: '/api/tenants/:id/invitations/:invitationId/resend',
    module: 'tenants',
    public: false,
  },
  {
    method: 'POST',
    path: '/api/tenants/:id/invitations/:invitationId/revoke',
    module: 'tenants',
    public: false,
  },
  { method: 'GET', path: '/api/tenants/:id/invitations/list', module: 'tenants', public: false },
  { method: 'GET', path: '/api/tenants/:id/members', module: 'tenants', public: false },
  {
    method: 'POST',
    path: '/api/tenants/:id/members/:userId/remove',
    module: 'tenants',
    public: false,
  },
  {
    method: 'POST',
    path: '/api/tenants/:id/members/:userId/role',
    module: 'tenants',
    public: false,
  },
  { method: 'POST', path: '/api/tenants/:id/members/add', module: 'tenants', public: false },
  { method: 'POST', path: '/api/tenants/:id/transfer-ownership', module: 'tenants', public: false },
  { method: 'POST', path: '/api/tenants/:id/update', module: 'tenants', public: false },
  { method: 'GET', path: '/api/tenants/:id/usage', module: 'billing', public: false },
  { method: 'POST', path: '/api/tenants/:id/usage/record', module: 'billing', public: false },
  { method: 'GET', path: '/api/tenants/:tenantId/activities', module: 'activities', public: false },
  { method: 'GET', path: '/api/tenants/list', module: 'tenants', public: false },
  { method: 'GET', path: '/api/users/list', module: 'users', public: false },
  { method: 'GET', path: '/api/users/me', module: 'users', public: false },
  { method: 'GET', path: '/api/users/me/agreements', module: 'legal', public: false },
  { method: 'GET', path: '/api/users/me/api-keys', module: 'api-keys', public: false },
  { method: 'DELETE', path: '/api/users/me/api-keys/:id', module: 'api-keys', public: false },
  { method: 'POST', path: '/api/users/me/api-keys/:id/revoke', module: 'api-keys', public: false },
  { method: 'POST', path: '/api/users/me/api-keys/create', module: 'api-keys', public: false },
  { method: 'PUT', path: '/api/users/me/avatar', module: 'users', public: false },
  { method: 'POST', path: '/api/users/me/avatar/delete', module: 'users', public: false },
  { method: 'GET', path: '/api/users/me/consent', module: 'consent', public: false },
  { method: 'PATCH', path: '/api/users/me/consent/update', module: 'consent', public: false },
  { method: 'POST', path: '/api/users/me/deactivate', module: 'users', public: false },
  { method: 'POST', path: '/api/users/me/delete', module: 'users', public: false },
  { method: 'GET', path: '/api/users/me/devices', module: 'auth', public: false },
  { method: 'DELETE', path: '/api/users/me/devices/:id', module: 'auth', public: false },
  { method: 'POST', path: '/api/users/me/devices/:id/trust', module: 'auth', public: false },
  { method: 'POST', path: '/api/users/me/export', module: 'data-export', public: false },
  { method: 'GET', path: '/api/users/me/export/:id/status', module: 'data-export', public: false },
  { method: 'GET', path: '/api/users/me/passkeys', module: 'auth', public: false },
  { method: 'PATCH', path: '/api/users/me/passkeys/:id', module: 'auth', public: false },
  { method: 'DELETE', path: '/api/users/me/passkeys/:id/delete', module: 'auth', public: false },
  { method: 'POST', path: '/api/users/me/password', module: 'users', public: false },
  { method: 'POST', path: '/api/users/me/phone', module: 'auth', public: false },
  { method: 'DELETE', path: '/api/users/me/phone/delete', module: 'auth', public: false },
  { method: 'POST', path: '/api/users/me/phone/verify', module: 'auth', public: false },
  { method: 'GET', path: '/api/users/me/profile-completeness', module: 'users', public: false },
  { method: 'POST', path: '/api/users/me/reactivate', module: 'users', public: false },
  { method: 'GET', path: '/api/users/me/sessions', module: 'users', public: false },
  { method: 'DELETE', path: '/api/users/me/sessions/:id', module: 'users', public: false },
  { method: 'GET', path: '/api/users/me/sessions/count', module: 'users', public: false },
  { method: 'POST', path: '/api/users/me/sessions/revoke-all', module: 'users', public: false },
  { method: 'PATCH', path: '/api/users/me/update', module: 'users', public: false },
  { method: 'PATCH', path: '/api/users/me/username', module: 'users', public: false },
  { method: 'POST', path: '/api/webhooks', module: 'webhooks', public: false },
  { method: 'GET', path: '/api/webhooks/:id', module: 'webhooks', public: false },
  { method: 'POST', path: '/api/webhooks/:id/delete', module: 'webhooks', public: false },
  { method: 'GET', path: '/api/webhooks/:id/deliveries', module: 'webhooks', public: false },
  { method: 'POST', path: '/api/webhooks/:id/rotate-secret', module: 'webhooks', public: false },
  { method: 'POST', path: '/api/webhooks/:id/update', module: 'webhooks', public: false },
  {
    method: 'POST',
    path: '/api/webhooks/deliveries/:deliveryId/replay',
    module: 'webhooks',
    public: false,
  },
  { method: 'GET', path: '/api/webhooks/list', module: 'webhooks', public: false },
] as const;

export type GeneratedRouteDefinition = (typeof generatedRouteDefinitions)[number];
export type GeneratedApiPath = GeneratedRouteDefinition['path'];
export type GeneratedApiMethod = GeneratedRouteDefinition['method'];
export type GeneratedRouteModule = GeneratedRouteDefinition['module'];

export type MethodsForPath<P extends GeneratedApiPath> = Extract<
  GeneratedRouteDefinition,
  { path: P }
>['method'];

export interface GeneratedApiClientConfig extends BaseClientConfig {
  defaultHeaders?: HeadersInit;
}

export interface GeneratedApiRequest<P extends GeneratedApiPath, M extends GeneratedApiMethod> {
  path: P;
  method: M;
  body?: unknown;
  query?: Record<string, string | number | boolean | null | undefined>;
  headers?: HeadersInit;
  signal?: AbortSignal;
}

function buildQueryString(
  query: Record<string, string | number | boolean | null | undefined> | undefined,
): string {
  if (query === undefined) return '';
  const params = new URLSearchParams();
  for (const [key, value] of Object.entries(query)) {
    if (value === undefined || value === null) continue;
    params.set(key, String(value));
  }
  const encoded = params.toString();
  return encoded.length > 0 ? `?${encoded}` : '';
}

export function createGeneratedApiClient(config: GeneratedApiClientConfig) {
  const baseUrl = trimTrailingSlashes(config.baseUrl);
  const fetchImpl = config.fetchImpl ?? fetch;
  const defaultHeaders = config.defaultHeaders;

  async function request<P extends GeneratedApiPath>(
    payload: GeneratedApiRequest<P, MethodsForPath<P>>,
  ): Promise<unknown> {
    const { path, method, body, headers, query, signal } = payload;
    const url = `${baseUrl}${path}${buildQueryString(query)}`;
    const mergedHeaders: HeadersInit = {
      'Content-Type': 'application/json',
      ...defaultHeaders,
      ...headers,
    };

    const requestInit: RequestInit = {
      method,
      headers: mergedHeaders,
      credentials: 'include',
      body: body === undefined ? null : JSON.stringify(body),
    };
    if (signal !== undefined) {
      requestInit.signal = signal;
    }

    const response = await fetchImpl(url, requestInit);

    const contentType = response.headers.get('content-type') ?? '';
    const isJson = contentType.includes('application/json');
    const parsedBody = isJson ? await response.json() : await response.text();

    if (!response.ok) {
      throw new Error(
        typeof parsedBody === 'string'
          ? parsedBody
          : JSON.stringify(parsedBody ?? { message: 'Request failed' }),
      );
    }

    return parsedBody;
  }

  return {
    routes: generatedRouteDefinitions,
    request,
  };
}
